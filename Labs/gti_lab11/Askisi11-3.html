<!DOCTYPE html>
<html id="html_thisHTML">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Άσκηση 11.3</title>
    <style>
      table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
      }
      th, td {
        padding: 15px;
      }
      td {
        width: 3ch;
        height: 3ch;
      }
    </style>
    <script>
      // var randomNumber, gameInterval;
      // var secondsLeft = 0;
      let gameStarted = false;
      let cellsSum = 0;
      let totalClicks = 0;
      function startGame() {
        var gameArray = document.getElementById("tbl_gameTable");
        gameStarted = true;
        document.getElementById("btn_start").disabled = gameStarted;
        // Γέμισμα στοιχείων με αρχικές τιμές και καθαρισμός
        for (i=0; i < gameArray.rows.length; i++)
            for (j=0; j < gameArray.rows[i].cells.length; j++) {
              let tmpColor = Math.round(Math.random() * 1);
              gameArray.rows[i].cells[j].innerHTML = Math.ceil((Math.random() * 9));
              if (tmpColor == 0)
                gameArray.rows[i].cells[j].style = "background-color: green";
              else
                if (tmpColor == 1)
                  gameArray.rows[i].cells[j].style = "background-color: red";
            }
      }
      // Αρχικοποίηση μεταβλητών παιχνιδιού
      function initGame() { 
        var gameArray = document.getElementById("tbl_gameTable");
        cellsSum = 0;
        totalClicks = 0;
        gameStarted = false;
        document.getElementById("btn_start").disabled = gameStarted;
        for (i=0; i < gameArray.rows.length; i++)
            for (j=0; j < gameArray.rows[i].cells.length; j++) {
              gameArray.rows[i].cells[j].innerHTML = "";
              gameArray.rows[i].cells[j].style = "background-color: white";
            }
      }
      function checkNumber(evt) {
        if (gameStarted)
          if (evt.target.tagName == "TD") { // ΣΕ ΠΕΡΙΠΤΩΣΗ ΠΟΥ ΤΟ border EINAI ΜΕΓΑΛΟ ΠΡΕΠΕΙ ΝΑ ΓΙΝΕΤΑΙ ΑΥΤΟΣ Ο ΕΛΕΓΧΟΣ
            var selectedCell = evt.target;
            totalClicks++;
            if (selectedCell.style.backgroundColor == "red") {
              cellsSum = cellsSum + selectedCell.innerHTML--;
              evt.target.style = "background-color: green";
            }
            else {
              cellsSum = cellsSum + selectedCell.innerHTML++;
              evt.target.style = "background-color: red";
            }
            console.log("gameStarted= " + gameStarted + ", cellsSum= " + cellsSum, ", totalClicks= ", totalClicks);
          }
          if (totalClicks == 10) {
            alert("Ο μέσος όρος είναι: " + cellsSum / totalClicks);
            initGame();
          }
      }
      // Η παρακάτω μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις - ΑΡΧΗ.
      var codeShown = false;
      function showCode() {
        if (codeShown) {
          btn_showCode.innerText = "Εμφάνιση κώδικα HTML";
          document.getElementById("div_showCode").removeChild(document.getElementById("area_htmlCode"));
        }
        else {
          let tmp_elm = document.createElement("textarea");
          tmp_elm.setAttribute("id", "area_htmlCode");
          tmp_elm.setAttribute("style", "position: absolute; width: inherit; height: 750px; left: 10px");
          div_showCode.appendChild(tmp_elm);
          area_htmlCode.value = html_thisHTML.outerHTML;
          btn_showCode.innerText = "Απόκρυψη κώδικα HTML";
        }
        codeShown = !codeShown;
        // Η παρακάτω μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις - ΤΕΛΟΣ.
    }
    </script>
  </head>
<body onload="btn_start.focus()">
  <input id="btn_start" type="button" onclick="startGame()" value="Έναρξη" style="margin-bottom: 40px;">
  <table id="tbl_gameTable" style="border:inset; padding: 5px;" onclick="checkNumber(event)">
        <tr>
          <td></td> <td></td> <td></td> <td></td> <td></td>
        </tr>
        <tr>
          <td></td> <td></td> <td></td> <td></td> <td></td>
        </tr>
        <tr>
          <td></td> <td></td> <td></td> <td></td> <td></td>
        </tr>
        <tr>
          <td></td> <td></td> <td></td> <td></td> <td></td>
        </tr>
        <tr>
          <td></td> <td></td> <td></td> <td></td> <td></td>
        </tr>
      </table>
    <br>
    <div id="div_remainingTime" style="height: 5ch; font-size: xx-large; padding-top: 20px;"></div><br><br>
    <!-- Το παρακάτω button μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις. ΑΡΧΗ -->
    <div id="div_showCode" style="position: absolute; border: solid 1px; width: 1000px; height: 800px; top: 50px; left:800px; padding: 10px;">
      <button id="btn_showCode" onclick="showCode()">Εμφάνιση κώδικα HTML</button><br>
    </div>
    <!-- Το παρακάτω button μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις. ΤΕΛΟΣ -->
  </body>
    <script>
      // Το παρακάτω button μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις. ΑΡΧΗ
      var tmpElem = document.getElementById("div_showCode");
      tmpElem.addEventListener("copy", function() {
        alert("ATTENTION!\nCopy is not recommended. This code is shown to you just for reference and NOT for use.\nΠΡΟΣΟΧΗ!\nΗ αντιγραφή δεν συστήνεται. Ο κώδικας αυτός είναι ορατός μόνο για αναφορά και ΟΧΙ για χρήση.");
          // TODO code here
        }, true
      );
      // Το παρακάτω button μπορεί να χρησιμοποιηθεί γενικά σε όλες τις ασκήσεις. ΤΕΛΟΣ
    </script>
</html>
